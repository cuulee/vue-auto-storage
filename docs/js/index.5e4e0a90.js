(function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/vue-auto-storage/",o(o.s=0)})({0:function(e,t,o){e.exports=o("c31f")},"42b1":function(e,t,o){"use strict";var r=o("e417"),n=o.n(r);n.a},"5e1d":function(e,t,o){"use strict";var r=o("88d4"),n=o.n(r);n.a},"5f72":function(e,t){e.exports=ELEMENT},6389:function(e,t){e.exports=VueRouter},7264:function(e,t,o){},"88d4":function(e,t,o){},"8bbf":function(e,t){e.exports=Vue},b238:function(e,t,o){"use strict";var r=o("7264"),n=o.n(r);n.a},c31f:function(e,t,o){"use strict";o.r(t);var r=o("8bbf"),n=o.n(r),a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("router-view",{attrs:{id:"app"}})},l=[],i={},s=i;o("42b1");function c(e,t,o,r,n,a,l,i){var s,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=o,c._compiled=!0),r&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),l?(s=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(l)},c._ssrRegister=s):n&&(s=i?function(){n.call(this,this.$root.$options.shadowRoot)}:n),s)if(c.functional){c._injectStyles=s;var u=c.render;c.render=function(e,t){return s.call(t),u(e,t)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,s):[s]}return{exports:e,options:c}}var u=c(s,a,l,!1,null,null,null),f=u.exports,d=o("6389"),m=o.n(d),p=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"demo-page"},[e._m(0),e._m(1),o("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"活动区域"}},[o("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}},[o("el-option",{attrs:{label:"区域一",value:"shanghai"}}),o("el-option",{attrs:{label:"区域二",value:"beijing"}})],1)],1),o("el-form-item",{attrs:{label:"即时配送"}},[o("el-switch",{model:{value:e.form.delivery,callback:function(t){e.$set(e.form,"delivery",t)},expression:"form.delivery"}})],1),o("el-form-item",{attrs:{label:"活动性质"}},[o("el-checkbox-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[o("el-checkbox",{attrs:{label:"美食/餐厅线上活动",name:"type"}}),o("el-checkbox",{attrs:{label:"地推活动",name:"type"}}),o("el-checkbox",{attrs:{label:"线下主题活动",name:"type"}}),o("el-checkbox",{attrs:{label:"单纯品牌曝光",name:"type"}})],1)],1),o("el-form-item",{attrs:{label:"特殊资源"}},[o("el-radio-group",{model:{value:e.form.resource,callback:function(t){e.$set(e.form,"resource",t)},expression:"form.resource"}},[o("el-radio",{attrs:{label:"线上品牌商赞助"}}),o("el-radio",{attrs:{label:"线下场地免费"}})],1)],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.handleClearCurrent}},[e._v("清空当前表单缓存")]),o("el-button",{attrs:{type:"warning"},on:{click:e.handleClearAll}},[e._v("清空所有缓存")])],1)],1),e._m(2),o("el-form",{attrs:{"label-width":"80px"}},[o("el-form-item",{attrs:{label:"活动名称"}},[o("el-input",{model:{value:e.deepObj.form,callback:function(t){e.$set(e.deepObj,"form",t)},expression:"deepObj.form"}})],1)],1)],1)},h=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("header",[o("h1",[e._v("Demo 1")])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("h2",[o("i",{staticClass:"el-icon-goods"}),e._v("\n    表单一：\n  ")])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("h2",{staticStyle:{"margin-top":"40px"}},[o("i",{staticClass:"el-icon-goods"}),e._v("\n    表单二：\n  ")])}],b={name:"Demo1",autoStorage:["form","deepObj.form"],data(){return{form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},deepObj:{form:""}}},methods:{handleClearCurrent(){this.$autoStorage.clear("form")},handleClearAll(){this.$autoStorage.clear()}},created(){},beforeDestroy(){}},v=b,_=(o("5e1d"),c(v,p,h,!1,null,null,null)),y=_.exports,g=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"demo-page"},[e._m(0),e._l(e.form,function(t,r){return o("section",{key:r},[o("header",[o("h2",{staticStyle:{"margin-top":"40px"}},[o("i",{staticClass:"el-icon-goods"}),e._v(" 表单 "+e._s(r+1)+"：\n      ")])]),o("el-form",{ref:"form",refInFor:!0,attrs:{model:t,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"活动名称"}},[o("el-input",{model:{value:t.name,callback:function(o){e.$set(t,"name",o)},expression:"item.name"}})],1),o("el-form-item",{attrs:{label:"即时配送"}},[o("el-switch",{model:{value:t.delivery,callback:function(o){e.$set(t,"delivery",o)},expression:"item.delivery"}})],1)],1)],1)}),o("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])],2)},$=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("header",[o("h1",[e._v("Demo 2")])])}],w={name:"Demo2",autoStorage:["form","form2","form3"],data(){return{form:[{name:"",delivery:!1}]}},methods:{handleAdd(){this.form.push({name:"",delivery:!1})}},beforeCreate(){},created(){},beforeDestroy(){}},x=w,S=(o("b238"),c(x,g,$,!1,null,null,null)),O=S.exports,k=new m.a({routes:[{path:"/",redirect:"/demo-1"},{path:"/demo-1",component:y},{path:"/demo-2",component:O}]}),C=o("5f72"),j=o.n(C);const T=!1,A="undefined"!==typeof console,E="color: #2db7f5;",F="color: #ff9900;";var P={info(...e){A&&T&&console.log.apply(null,["%c[Auto Storage]:",E,...e])},tip(...e){A&&T&&console.log.apply(null,["%c[Auto Storage]:",F,...e])},warn(...e){A&&T&&console.error.apply(null,["[Auto Storage error]:",...e])}};const I=window.localStorage;var R={set(e,t){I.setItem(e,JSON.stringify(t||null))},get(e){const t=I[e];return"undefined"===typeof t?void 0:JSON.parse(t)},remove(e){I[e]&&I.removeItem(e)},clear(e){if(e)for(const t of Object.keys(I))-1!==t.indexOf(e)&&I.removeItem(t);else I.clear()}};const D="__AUTO_STORAGE__";function N(e){return Object.prototype.toString.call(e).slice(8,-1)}function U(e){const t=/(\[\w+\])$/g;if(t.test(e)){const t=e.lastIndexOf("[");return[e.slice(0,t),e.slice(t+1,-1)]}{const t=e.lastIndexOf(".");return[e.slice(0,t),e.slice(t+1)]}}function V(e,t=300){let o;return function(...r){o&&clearTimeout(o),o=setTimeout(()=>{e.apply(this,r)},t)}}function M(e,t,o){t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");const r=t.split(".");for(const n of r){if(!(n in e))return o;e=e[n]}return e}class G{constructor(e){this.$vm=e,this.unwatchFns=Object.create(null),this.prefix=D+e.$options.name+"__",this.debounce=e.__AUTO_STORAGE_OPTIONS__.debounce}getPrefix(e){return this.prefix+e.toUpperCase()}recovery(e){const t=this.getPrefix(e);return R.get(t)}watch(e){if(!e)return;if(this.unwatchFns[e])return;const t=this.getPrefix(e);P.info("before add watch",this.$vm.$options.name,e),this.unwatchFns[e]=this.$vm.$watch(e,V(o=>{P.tip("run watch",this.$vm.$options.name,e),R.set(t,o)},this.debounce),{deep:!0})}unwatch(e){e&&e in this.unwatchFns&&(this.unwatchFns[e](),delete this.unwatchFns[e])}unwatchAll(){for(const e in this.unwatchFns)this.unwatchFns[e]();delete this.unwatchFns,this.unwatchFns=Object.create(null)}clear(e){e?R.remove(this.getPrefix(e)):R.clear(D)}destroy(){this.unwatchAll(),delete this.$vm,delete this.prefix,delete this.debounce}}const J=/(\.|\[|\])/g;function X(e){e.$options.autoStorage&&e.$options.name&&(e.$autoStorage||(e.$autoStorage=new G(e),q(e),e.$nextTick(()=>{B(e)})))}function L(e){e.$autoStorage&&(e.$autoStorage.destroy(),delete e.$autoStorage)}function q(e){const t=e.$options.autoStorage,o=N(t);switch(o){case"Array":for(const o of t){const t=e.$autoStorage.recovery(o);void 0!==t&&z(e,o,t)}break;case"Object":break;default:}}function z(e,t,o){if(J.test(t)){P.info("recovery",t,"[nested]");const[r,n]=U(t),a=M(e,r);a[n]=o}else P.info("recovery",t,"[non-nested]"),e[t]=o}function B(e){const t=e.$options.autoStorage,o=N(t);switch(o){case"Array":for(const o of t)"undefined"!==typeof M(e,o)&&e.$autoStorage.watch(o);break;case"Object":break;default:}}var H={created(){try{X(this)}catch(e){P.warn(e)}},beforeDestroy(){L(this)}};const K={debounce:300},Q={install(e,t={}){for(const o in t)K[o]=t[o];e.prototype.__AUTO_STORAGE_OPTIONS__=K,e.mixin(H)}};"undefined"!==typeof window&&window.Vue&&window.Vue.use(Q);var W=Q;n.a.config.productionTip=!1,n.a.use(j.a),n.a.use(W),new n.a({router:k,render:e=>e(f)}).$mount("#app")},e417:function(e,t,o){}});
//# sourceMappingURL=index.5e4e0a90.js.map